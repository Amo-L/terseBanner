<!DOCTYPE html>
<html>
<head>
	<title>Preload - no - easyBanner</title>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<div class="banner-preload">
		<ul></ul>
	</div>
	<div class="console-panle" style="font: 18px/25px Arial;"></div>
</body>
<script type="text/javascript" src="../lib/highlight.min.js"></script>
<script type="text/javascript" src="../lib/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="../src/jquery.easyBanner.js"></script>
<!-- <script type="text/javascript" src="script.js"></script> -->
<script>
	$(function() {
		var srcArr = [
			"http://img.bizhi.sogou.com/images/2014/09/15/876564.jpg",
			"http://img.bizhi.sogou.com/images/2014/09/19/881411.jpg",
			"http://img.bizhi.sogou.com/images/2014/09/15/876561.jpg",
			"http://img.bizhi.sogou.com/images/2014/09/15/876559.jpg",
			"http://img.bizhi.sogou.com/images/2015/05/29/1184400.jpg",
			"http://img.bizhi.sogou.com/images/2014/09/15/876564.jpg",
			"http://img.bizhi.sogou.com/images/2014/09/19/881411.jpg",
			"http://img.bizhi.sogou.com/images/2014/09/15/876561.jpg",
			"http://img.bizhi.sogou.com/images/2014/09/15/876559.jpg",
			"http://img.bizhi.sogou.com/images/2015/05/29/1184400.jpg",
		];

		for (var i = 0, len = srcArr.length; i < len; i++) {
			$('.banner-preload ul').append('<li><img src="' + srcArr[i] + '?cache=' + Math.random() + '"></li>');
		}

		var log = '';
		var timeCount = 0;
		var $item = $('.banner-preload ul li');

		$item.each(function() {
			var $this = $(this),
				$img  = $(this).find('img'),
				img   = new Image(); 

			$(this).addClass('loading');

			img.src = $img.attr('src');
			if (img.complete) {
				$this.removeClass().addClass('loaded');
			} else {
				img.onload = function() {
					$this.removeClass().addClass('loaded');
				};
			}
		});
		
		$('.banner-preload').easyBanner();

		timer = setInterval(function() {
			var log = '';

			$item.each(function() {
				if ($(this).hasClass('loaded')) {
					log += '<p>' + ($(this).index() + 1) + 'th image was loaded</p>';
				} else {
					log += '<p>' + ($(this).index() + 1) + 'th image is loading</p>';
				}

				$('.console-panle').html(log);
			});

			timeCount += 10;

			if (!$item.filter('[class!="loaded"]').length) {
				log += '<p><b>All of the images have finished loadingÔºÅSpent ' + timeCount + 'ms</p>';

				$('.console-panle').html(log);

				clearInterval(timer);
			}
		}, 10);
	});
</script>
</html>