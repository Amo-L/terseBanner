<!DOCTYPE html>
<html>
<head>
	<title>Preload - no - easyBanner</title>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<div class="banner-preload">
		<ul>
			<li><img src="http://img.bizhi.sogou.com/images/2014/09/15/876564.jpg"></li>
			<li><img src="http://img.bizhi.sogou.com/images/2014/09/19/881411.jpg"></li>
			<li><img src="http://img.bizhi.sogou.com/images/2014/09/15/876561.jpg"></li>
			<li><img src="http://img.bizhi.sogou.com/images/2014/09/15/876559.jpg"></li>
			<li><img src="http://img.bizhi.sogou.com/images/2015/05/29/1184400.jpg"></li>
			
			<li><img src="http://img.bizhi.sogou.com/images/2014/09/15/876564.jpg"></li>
			<li><img src="http://img.bizhi.sogou.com/images/2014/09/19/881411.jpg"></li>
			<li><img src="http://img.bizhi.sogou.com/images/2014/09/15/876561.jpg"></li>
			<li><img src="http://img.bizhi.sogou.com/images/2014/09/15/876559.jpg"></li>
			<li><img src="http://img.bizhi.sogou.com/images/2015/05/29/1184400.jpg"></li>
		</ul>
	</div>
	<div class="console-panle" style="font: 18px/25px Arial;"></div>
</body>
<script type="text/javascript" src="../lib/highlight.min.js"></script>
<script type="text/javascript" src="../lib/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="../src/jquery.easyBanner.js"></script>
<!-- <script type="text/javascript" src="script.js"></script> -->
<script>
	$(function() {
		$('.banner-preload ul li').each(function() {
			var $this = $(this),
				$img  = $(this).find('img'),
				src   = $img.attr('src'),
				img   = new Image(); 

			$(this).addClass('loading');
			$img.attr('src', src + '?cache=' + Math.random());

			img.src = $img.attr('src');
			if (img.complete) {
				$this.removeClass().addClass('loaded');
			} else {
				img.onload = function() {
					$this.removeClass().addClass('loaded');
				};
			}
		});

		$('.banner-preload').easyBanner();

		var timeCount = 0;
		var $item = $('.banner-preload ul li:not(":last-child")'); // last item is a clone

		timer = setInterval(function() {
			var log = '';

			$item.each(function() {
				if ($(this).hasClass('loaded')) {
					log += '<p>' + ($(this).index() + 1) + 'th image was loaded</p>';
				} else {
					log += '<p>' + ($(this).index() + 1) + 'th image is loading</p>';
				}

				$('.console-panle').html(log);
			});


			timeCount += 10;

			if (!$item.filter('[class!="loaded"]').length) {
				log += '<p><b>All of the images have finished loadingÔºÅSpent ' + timeCount + 'ms</p>';

				$('.console-panle').html(log);

				clearInterval(timer);
			}
		}, 10);
	});
</script>
</html>